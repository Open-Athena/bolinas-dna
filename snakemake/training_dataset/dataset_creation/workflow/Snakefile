configfile: "config/config.yaml"


SPLITS = ["train", "validation"]
N_SHARDS = config["n_shards"]
assert N_SHARDS < 1e4
SHARDS = [f"shard_{i:04}" for i in range(N_SHARDS)]


include: "rules/common.smk"


genomes = load_genome_info(config["genomes_path"])
genome_sets = load_genome_sets(genomes, config["genome_sets"])
genome_sets_list = list(genome_sets.keys())
intervals_list = config["intervals"]


include: "rules/download.smk"
include: "rules/intervals.smk"
include: "rules/dataset.smk"


rule all:
    input:
        expand(
            "results/upload.done/{genome_set}/{intervals}",
            genome_set=genome_sets_list,
            intervals=config["intervals"],
        ),


# network-constrained
rule all_download:
    input:
        expand("results/genome/{g}.2bit", g=genomes.index),
