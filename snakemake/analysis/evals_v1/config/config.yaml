# Genome reference (GRCh38)
genome_url: http://ftp.ensembl.org/pub/release-113/fasta/homo_sapiens/dna/Homo_sapiens.GRCh38.dna.primary_assembly.fa.gz

# Model checkpoints to evaluate
# Each model has a base name, base path, context size, and list of checkpoint steps
models:
  - name: animal_promoters_yolo_repeat_downweight
    base_path: /home/ubuntu/efs/projects/biofoundation/data/marin_checkpoints/animal-promoters-yolo-r01-213a8e
    context_size: 512
    steps:
      - 2000
      - 6000
      - 10000
      - 12000
      - 14000
      - 16000
      - 18000
      - 20000
      - 22000

  - name: animal_cds_yolo_repeat_downweight
    base_path: /home/ubuntu/efs/projects/biofoundation/data/marin_checkpoints/animal-cds-yolo-repeat-weight-0.01-r01-e8cb9b
    context_size: 512
    steps:
      - 2000
      - 6000
      - 10000
      - 16000
      - 24000
      - 32000
      - 34000

  - name: animal_mrna_plus_promoters_yolo_repeat_downweight
    base_path: /home/ubuntu/efs/projects/biofoundation/data/marin_checkpoints/animal-mRNA-plus-promoters-yolo-repeat-weight-0.01-r01-b9ca25
    context_size: 512
    steps:
      - 2000
      - 6000
      - 10000
      - 16000
      - 24000
      - 26000

  - name: animal_promoters_yolo
    base_path: /home/ubuntu/efs/projects/biofoundation/data/marin_checkpoints/animal-promoters-yolo-standard-r01-a615b7
    context_size: 512
    steps:
      - 2000
      - 6000
      - 10000
      - 12000
      - 14000
      - 16000
      - 18000
      - 20000
      - 22000
      - 24000
      - 26000
      - 28000

  - name: animal_mrna_plus_promoters
    base_path: /home/ubuntu/efs/projects/biofoundation/data/marin_checkpoints/animal-mRNA-plus-promoters-yolo-r01-a3e7b3
    context_size: 512
    steps:
      - 2000
      - 6000
      - 10000
      - 12000

  - name: promoter_cds_mixture_equal
    base_path: /home/ubuntu/efs/projects/biofoundation/data/marin_checkpoints/promoter-cds-mixture-equal-r01-b67fd1
    context_size: 512
    steps:
      - 2000
      - 10000
      - 16000
      - 26000

  - name: promoter_cds_mixture_proportional
    base_path: /home/ubuntu/efs/projects/biofoundation/data/marin_checkpoints/promoter-cds-mixture-proportional-r01-6705f1
    context_size: 512
    steps:
      - 2000
      - 10000
      - 16000
      - 26000

  - name: exp41-genomes-v4-genome_set-animals-intervals-v1_512_256-r02-cea8f7
    base_path: /home/ubuntu/efs/projects/biofoundation/data/marin_checkpoints/exp41-genomes-v4-genome_set-animals-intervals-v1_512_256-r02-cea8f7
    context_size: 512
    steps:
      - 1000
      - 2000
      - 3000
      - 4000
      - 5000
      - 6000
      - 7000
      - 8000
      - 9000
      - 9999

  - name: exp41-genomes-v4-genome_set-animals-intervals-v4_512_256-r02-985ba6
    base_path: /home/ubuntu/efs/projects/biofoundation/data/marin_checkpoints/exp41-genomes-v4-genome_set-animals-intervals-v4_512_256-r02-985ba6
    context_size: 512
    steps:
      - 1000
      - 2000
      - 3000
      - 4000
      - 5000
      - 6000
      - 7000
      - 8000
      - 9000
      - 9999

  - name: exp37-genomes-v4-genome_set-animals-intervals-v1_256_128-r02-4e2580
    base_path: /home/ubuntu/efs/projects/biofoundation/data/marin_checkpoints/exp37-genomes-v4-genome_set-animals-intervals-v1_256_128-r02-4e2580
    context_size: 256
    steps:
      - 1000
      - 2000
      - 3000
      - 4000
      - 5000
      - 6000
      - 7000
      - 8000
      - 9000
      - 9999

  - name: exp43-ncrna-r01-1cd7d3
    base_path: /home/ubuntu/efs/projects/biofoundation/data/marin_checkpoints/exp43-ncrna-r01-1cd7d3
    context_size: 256
    steps:
      - 1000
      - 5000
      # - 9999

  - name: exp43-five_prime_utr-r01-7742ae
    base_path: /home/ubuntu/efs/projects/biofoundation/data/marin_checkpoints/exp43-five_prime_utr-r01-7742ae
    context_size: 256
    steps:
      - 1000
      - 5000
      # - 9999

  - name: exp43-three_prime_utr-r01-16f6cf
    base_path: /home/ubuntu/efs/projects/biofoundation/data/marin_checkpoints/exp43-three_prime_utr-r01-16f6cf
    context_size: 256
    steps:
      - 1000
      - 5000
      # - 9999

  - name: exp43-cds-r01-976f2d
    base_path: /home/ubuntu/efs/projects/biofoundation/data/marin_checkpoints/exp43-cds-r01-976f2d
    context_size: 256
    steps:
      - 1000
      - 5000
      # - 9999

# Evaluation datasets from HuggingFace
# Each dataset should have been created by the snakemake/evals pipeline
datasets:
  - name: traitgym_mendelian
    hf_path: gonzalobenegas/bolinas_evals-traitgym_mendelian
    split: train
    metrics:
      - AUPRC

  - name: traitgym_complex
    hf_path: gonzalobenegas/bolinas_evals-traitgym_complex
    split: train
    metrics:
      - AUPRC

  - name: clinvar_missense
    hf_path: gonzalobenegas/bolinas_evals-clinvar_missense
    split: train
    metrics:
      - AUROC

  - name: gwas_missense
    hf_path: gonzalobenegas/bolinas_evals-gwas_coding
    split: train
    metrics:
      - AUPRC

#   - name: gnomad_pls_v2
#     hf_path: gonzalobenegas/bolinas_evals-gnomad_pls_v2
#     split: train
#     metrics:
#       - AUPRC

# Baseline models to compare against (pre-computed on HuggingFace)
baselines:
  models:
    - model: GPN-Star-V100
      name: "GPN-Star (V)"
    - model: GPN-Star-M447
      name: "GPN-Star (M)"
    - model: GPN-Star-P243
      name: "GPN-Star (P)"
    - model: Evo2_40B
      name: "Evo 2 (40B)"
    - model: Evo2_7B
      name: "Evo 2 (7B)"

  # Mapping from our dataset names to original TraitGym dataset paths
  dataset_mapping:
    traitgym_mendelian: songlab/omim_traitgym
    traitgym_complex: songlab/ukb_finemapped_nc_traitgym
    clinvar_missense: songlab/clinvar_vs_benign
    gwas_missense: songlab/ukb_finemapped_coding

# Score types to evaluate and plot
score_types:
  - minus_llr
  - abs_llr
  - embed_last_l2
  - embed_middle_l2

# Custom filtered model comparison plots
# Each plot can filter which models and which (dataset, subset) combinations to include
# Each dataset_subset can specify its own score_type
custom_plots:
  - name: promoters_yolo
    title: "Promoters YOLO run (Qwen 1.7B)"
    models:
      - model: animal_promoters_yolo_repeat_downweight
    n_cols: 2
    dataset_subsets:
      - dataset: traitgym_mendelian
        subset: nonexonic_AND_proximal
        score_type: minus_llr
        include_baselines: true
        title: "TraitGym Mendelian Promoter"
      - dataset: traitgym_mendelian
        subset: 5_prime_UTR_variant
        score_type: minus_llr
        include_baselines: true
        title: "TraitGym Mendelian 5' UTR"
      - dataset: traitgym_complex
        subset: nonexonic_AND_proximal
        score_type: abs_llr
        include_baselines: true
        title: "TraitGym Complex Promoter"
      - dataset: traitgym_complex
        subset: 5_prime_UTR_variant
        score_type: abs_llr
        include_baselines: true
        title: "TraitGym Complex 5' UTR"

  - name: cds_yolo
    title: "CDS YOLO run (Qwen 1.7B)"
    models:
      - model: animal_cds_yolo_repeat_downweight
    n_cols: 2
    dataset_subsets:
      - dataset: clinvar_missense
        subset: global
        score_type: minus_llr
        include_baselines: true
        title: "ClinVar missense"
      - dataset: gwas_missense
        subset: global
        score_type: abs_llr
        include_baselines: true
        title: "GWAS missense"

  - name: all_models_comparison
    title: "All Models Comparison (Qwen 1.7B)"
    models:
      - model: animal_promoters_yolo_repeat_downweight
        title: "trained on promoters"
      - model: animal_cds_yolo_repeat_downweight
        title: "trained on CDS"
      - model: animal_mrna_plus_promoters_yolo_repeat_downweight
        title: "trained on promoters + CDS + UTR"
    n_cols: 3
    dataset_subsets:
      # mendelian
      - dataset: traitgym_mendelian
        subset: nonexonic_AND_proximal
        score_type: minus_llr
        include_baselines: true
        title: "Mendelian Promoter"
      - dataset: traitgym_mendelian
        subset: 5_prime_UTR_variant
        score_type: minus_llr
        include_baselines: true
        title: "Mendelian 5' UTR"
      - dataset: clinvar_missense
        subset: global
        score_type: minus_llr
        include_baselines: true
        title: "ClinVar missense"
      # complex
      - dataset: traitgym_complex
        subset: nonexonic_AND_proximal
        score_type: abs_llr
        include_baselines: true
        title: "Complex Promoter"
      - dataset: traitgym_complex
        subset: 5_prime_UTR_variant
        score_type: abs_llr
        include_baselines: true
        title: "Complex 5' UTR"
      - dataset: gwas_missense
        subset: global
        score_type: abs_llr
        include_baselines: true
        title: "GWAS missense"

  - name: promoters_repeat_downweight
    title: "Promoter models"
    models:
      - model: animal_promoters_yolo_repeat_downweight
        title: "downweight repeats"
      - model: animal_promoters_yolo
        title: "standard"
    n_cols: 2
    dataset_subsets:
      - dataset: traitgym_mendelian
        subset: nonexonic_AND_proximal
        score_type: minus_llr
        include_baselines: true
        title: "Mendelian Promoter"
      - dataset: traitgym_mendelian
        subset: 5_prime_UTR_variant
        score_type: minus_llr
        include_baselines: true
        title: "Mendelian 5' UTR"
      - dataset: traitgym_complex
        subset: nonexonic_AND_proximal
        score_type: abs_llr
        include_baselines: true
        title: "Complex Promoter"
      - dataset: traitgym_complex
        subset: 5_prime_UTR_variant
        score_type: abs_llr
        include_baselines: true
        title: "Complex 5' UTR"

  - name: mrna_plus_promoters_repeat_downweight
    title: "mRNA + promoters models"
    models:
      - model: animal_mrna_plus_promoters_yolo_repeat_downweight
        title: "downweight repeats"
      - model: animal_mrna_plus_promoters
        title: "standard"
    n_cols: 3
    dataset_subsets:
      - dataset: traitgym_mendelian
        subset: nonexonic_AND_proximal
        score_type: minus_llr
        include_baselines: true
        title: "Mendelian Promoter"
      - dataset: traitgym_mendelian
        subset: 5_prime_UTR_variant
        score_type: minus_llr
        include_baselines: true
        title: "Mendelian 5' UTR"
      - dataset: clinvar_missense
        subset: global
        score_type: minus_llr
        include_baselines: true
        title: "ClinVar missense"
      - dataset: traitgym_complex
        subset: nonexonic_AND_proximal
        score_type: abs_llr
        include_baselines: true
        title: "Complex Promoter"
      - dataset: traitgym_complex
        subset: 5_prime_UTR_variant
        score_type: abs_llr
        include_baselines: true
        title: "Complex 5' UTR"
      - dataset: gwas_missense
        subset: global
        score_type: abs_llr
        include_baselines: true
        title: "GWAS missense"

  - name: promoter_cds_mixture
    title: "Promoter + CDS mixture (Qwen 1.7B)"
    # Colors from viridis colormap: plt.cm.viridis(promoter_fraction)
    models:
      - model: animal_promoters_yolo_repeat_downweight
        title: "100% promoters + 0% CDS"
        color: "#fde725"  # viridis(1.0)
      - model: promoter_cds_mixture_equal
        title: "50% promoters + 50% CDS (equal)"
        color: "#21918c"  # viridis(0.5)
      - model: promoter_cds_mixture_proportional
        title: "10% promoters + 90% CDS (proportional)"
        color: "#482475"  # viridis(0.1)
      - model: animal_cds_yolo_repeat_downweight
        title: "0% promoters + 100% CDS"
        color: "#440154"  # viridis(0.0)
    n_cols: 2
    dataset_subsets:
      - dataset: traitgym_mendelian
        subset: nonexonic_AND_proximal
        score_type: minus_llr
        include_baselines: true
        title: "Mendelian promoter"
      - dataset: clinvar_missense
        subset: global
        score_type: minus_llr
        include_baselines: true
        title: "ClinVar missense"

  - name: exp41_promoters_mrna_ncrna
    title: "Exp41 promoters from mRNA vs. ncRNA"
    models:
      - model: exp41-genomes-v4-genome_set-animals-intervals-v1_512_256-r02-cea8f7
        title: "mRNA"
      - model: exp41-genomes-v4-genome_set-animals-intervals-v4_512_256-r02-985ba6
        title: "mRNA + ncRNA"
    n_cols: 2
    dataset_subsets:
      - dataset: traitgym_mendelian
        subset: nonexonic_AND_proximal
        score_type: minus_llr
        include_baselines: true
        title: "Mendelian Promoter"
      - dataset: traitgym_mendelian
        subset: 5_prime_UTR_variant
        score_type: minus_llr
        include_baselines: true
        title: "Mendelian 5' UTR"
      - dataset: traitgym_mendelian
        subset: non_coding_transcript_exon_variant
        score_type: minus_llr
        include_baselines: true
        title: "Mendelian ncRNA"

  - name: exp37_context_size
    title: "Exp37 context size"
    models:
      - model: exp41-genomes-v4-genome_set-animals-intervals-v1_512_256-r02-cea8f7
        title: "512bp"
      - model: exp37-genomes-v4-genome_set-animals-intervals-v1_256_128-r02-4e2580
        title: "256bp"
    n_cols: 2
    dataset_subsets:
      - dataset: traitgym_mendelian
        subset: nonexonic_AND_proximal
        score_type: minus_llr
        include_baselines: true
        title: "Mendelian Promoter"
      - dataset: traitgym_mendelian
        subset: 5_prime_UTR_variant
        score_type: minus_llr
        include_baselines: true
        title: "Mendelian 5' UTR"

  - name: exp43_functional_regions
    title: "Exp43 functional regions"
    models:
      - model: exp43-cds-r01-976f2d
        title: "CDS"
      - model: exp43-five_prime_utr-r01-7742ae
        title: "5' UTR"
      - model: exp43-three_prime_utr-r01-16f6cf
        title: "3' UTR"
      - model: exp43-ncrna-r01-1cd7d3
        title: "ncRNA"
      - model: exp37-genomes-v4-genome_set-animals-intervals-v1_256_128-r02-4e2580
        title: "Promoter (WIP)"
    n_cols: 2
    dataset_subsets:
      - dataset: traitgym_mendelian
        subset: nonexonic_AND_proximal
        score_type: minus_llr
        include_baselines: true
        title: "Mendelian Promoter"
      - dataset: traitgym_mendelian
        subset: nonexonic_AND_distal
        score_type: minus_llr
        include_baselines: true
        title: "Mendelian Distal"
      - dataset: traitgym_mendelian
        subset: 5_prime_UTR_variant
        score_type: minus_llr
        include_baselines: true
        title: "Mendelian 5' UTR"
      - dataset: traitgym_mendelian
        subset: 3_prime_UTR_variant
        score_type: minus_llr
        include_baselines: true
        title: "Mendelian 3' UTR"
      - dataset: traitgym_mendelian
        subset: non_coding_transcript_exon_variant
        score_type: minus_llr
        include_baselines: true
        title: "Mendelian ncRNA"

# Inference configuration (performance settings that don't affect output)
inference:
  batch_size: 128
  num_workers: 4
  data_transform_on_the_fly: true
  torch_compile: false
